<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />

<div class="content">
    <header>
        <div>
            <h1>Library Manager</h1>
        </div>
        <div>
            <p>{{ text }}</p>
        </div>
    </header>
    <br/>
    <div class="tab-bar-wrapper">
        <a class="nav-bar normal-btn active-btn" id="page_0_nav" href="javascript:onChangeNavTab(0);">View All</a>
        <a class="nav-bar normal-btn" id="page_1_nav" href="javascript:onChangeNavTab(1);">Upload</a>
        <a class="nav-bar normal-btn" id="page_2_nav" href="javascript:onChangeNavTab(2);">Git</a>
    </div>
    <br/>
    <br/>
    <div>
        <div class="page-content" id="page_0_content">{{ include('admin/library/LibraryViewAll.twig') }}</div>
        <div class="page-content" id="page_1_content" style="display: none;"> {{ include('admin/library/LibraryUpload.twig') }}</div>
        <div class="page-content" id="page_2_content" style="display: none;"> {{ include('admin/library/LibraryGit.twig') }}</div>
    </div>
</div>

<script type="text/javascript">
    function onChangeNavTab(tab) {
        if (tab > 2 || tab < 0) {
            alert('Invalid Navigation');
            return;
        }

        $('.page-content').hide();
        $('#page_' + tab + '_content').show();
        for (var i = 0; i < 3; i++)
            {
            $('#page_' + i + '_nav').removeClass('active-btn');
        }
        $('#page_' + tab + '_nav').addClass('active-btn');
    }
    function managerSubmitAjax(url, type, data, disableBtn) {
        data.csrf_token = '{{ csrf_token }}';
        document.body.style.cursor='wait';
        disableBtn.disabled = true;
        $.ajax({
            url: url,
            data: data,
            type: type,
            success: function(returnedData) {
                try {
                    var jsondata = JSON.parse(returnedData);
                    console.log(returnedData);
                    if (jsondata['status'] === "success") {
                        displaySubmissionMessage(jsondata);
                        // reload after showing message for a second
                        setTimeout(function(){ location.reload(true); }, 1000);
                    } else {
                        displaySubmissionMessage(jsondata);
                    }
                    document.body.style.cursor='default';
                    disableBtn.disabled = false;
                }
                catch (e) {
                    displaySubmissionMessage({
                        status: "fail",
                        message: "Error parsing response from server."
                    });
                }
                document.body.style.cursor='default';
                disableBtn.disabled = false;
            },
            error: function(request, status, error) {
                displaySubmissionMessage({
                    status: "fail",
                    message: request.responseText
                });
            }
        });
    }
</script>

